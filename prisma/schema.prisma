generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum userStatus {
  active
  inactive
  blocked
}

enum accountType {
  user
  admin
}

enum TokenStatus {
  active
  inactive
}

enum AuthProvider {
  local
  google
}

model user {
  id              Int          @id @default(autoincrement())
  firstName       String?      @db.VarChar(255)
  lastName        String?      @db.VarChar(255)
  email           String       @unique @db.VarChar(255)
  username        String       @unique @db.VarChar(255)
  password        String?      @db.VarChar(255)
  phoneNumber     String?      @unique @db.VarChar(500)
  status          userStatus   @default(inactive)
  accountType     accountType  @default(user)
  firstLogin      Boolean      @default(true)
  phoneIsVerified Boolean      @default(false)
  emailIsVerified Boolean      @default(false)
  emailOtp        String?      @db.VarChar(6)
  phoneOtp        String?      @db.VarChar(6)
  emailOtpExpiry  DateTime?
  phoneOtpExpiry  DateTime?
  googleId        String?      @unique
  authProvider    AuthProvider @default(local)
  profilePicture  String?      @db.VarChar(255)
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt
  tokens          token[]

  @@index([email])
}

model token {
  id           Int         @id @default(autoincrement())
  userId       Int
  user         user        @relation(fields: [userId], references: [id], onDelete: Cascade)
  jwtToken     String      @db.Text
  refreshToken String      @db.Text
  createdByIp  String?     @db.VarChar(100)
  status       TokenStatus @default(active)
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt

  @@index([userId])
}
